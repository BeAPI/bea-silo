'use strict';var _silo=require('./src/silo'),_silo2=_interopRequireDefault(_silo);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}_silo2.default.bind('.silo');
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(exports,'__esModule',{value:!0});require('../polyfill/forEach');var _utils=require('./utils');function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var Silo=function(){function a(b,c){var d=this,e=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],f=arguments[3];_classCallCheck(this,a),this.name=b,this.container=c,this.preview=e,this.terms=bea_silo.objects[this.name].terms,this.baseSlug=bea_silo.objects[this.name].base_slug,this.scrollable=f,this.init(),this.container.addEventListener('click',this.handleClick.bind(this)),window.onpopstate=function(){d.container.innerHTML='',d.init()}}return _createClass(a,null,[{key:'bind',value:function bind(b){var c=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];document.querySelectorAll(b).forEach(function(b){var d=b.dataset.preview,e=b.dataset.name,f=new a(e,b,d,c);return f})}}]),_createClass(a,[{key:'checkUrl',value:function checkUrl(){for(var a=this,b=window.location.href,c=this.terms.filter(function(a){return a.term_link===b})[0],d=[],e=function(b,e){if(!d.length){var f=a.terms.filter(function(a){return a.term_id===c.term_id})[0].term_id;d.push(f)}else{var g=a.terms.filter(function(a){return a.term_id===d[e-1]})[0].parent;d.push(g)}},f=c.level+1,g=0;0<=f;f--,g++)e(f,g);var h=d.reverse();this.scrollable?h.forEach(function(b,c){a.container.querySelector('.silo__item[data-id="'+b+'"]')&&a.container.querySelector('.silo__item[data-id="'+b+'"]').classList.add('active'),a.displayLevel(c,b)}):(this.displayLevel(),this.container.querySelector('.silo__item[data-id="'+h[1]+'"]').classList.add('active'),this.displayLevel(h.length-1,h[h.length-1]))}},{key:'handleClick',value:function handleClick(a){var b=a.target.parentNode;if(!this.preview&&b.classList.contains('silo__item')){if(0<b.dataset.childrens.length&&a.preventDefault(),b.classList.contains('active')){var g=parseInt(b.dataset.level);return this.removePrevRow(b,g),void this.handlePrevHistory(b)}var c=parseInt(b.dataset.level),d=parseInt(b.dataset.id),e=b.dataset.link,f=b.dataset.slug;this.removePrevRow(b,c),this.handleActiveClass(b),window.history.pushState(f,f,e),this.displayLevel(c+1,d)}}},{key:'handlePrevHistory',value:function handlePrevHistory(a){var b=this.terms.filter(function(b){return b.childrens.length&&b.childrens.includes(parseInt(a.dataset.id))})[0];b?window.history.pushState(b.slug,b.slug,b.term_link):window.history.pushState(this.baseSlug,this.baseSlug,window.location.protocol+'//'+window.location.host+'/'+this.baseSlug),this.scrollable&&(0,_utils.scrollIt)(a.parentNode,50,300)}},{key:'handleActiveClass',value:function handleActiveClass(a){var b=a.parentNode,c=b.querySelectorAll('.silo__item');c.forEach(function(a){return a.classList.remove('active')}),a.classList.add('active')}},{key:'removePrevRow',value:function removePrevRow(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=document.querySelectorAll('.silo__row');c.forEach(function(a){var c=a.dataset.level;c>b&&a.parentNode.removeChild(a)}),a.classList.remove('active')}},{key:'createRow',value:function createRow(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=document.createElement('DIV');return b.classList.add('silo__row','silo__row--'+a),b.setAttribute('data-level',a),b}},{key:'displayLevel',value:function displayLevel(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=this.terms.filter(function(c){return c.level===a&&c.parent===b}),d=this.createRow(a),e=this.container.querySelector('.silo__row--'+(a-1));c.forEach(function(b){var c=document.createElement('DIV');c.setAttribute('data-level',a),c.setAttribute('data-childrens',b.childrens),c.setAttribute('data-id',b.term_id),c.setAttribute('data-slug',b.slug),c.setAttribute('data-link',b.term_link),c.classList.add('silo__item','silo__item--'+a),c.innerHTML='<a href="'+b.term_link+'">\n                        <span class="item__title">\n                          '+b.name+'\n                        </span>\n                      </a>',d.appendChild(c)}),!this.scrollable&&1<a&&e&&e.parentNode.removeChild(e),this.container.appendChild(d),0!==a&&(0,_utils.fadeIn)(d),this.scrollable&&(0,_utils.scrollIt)(d,50,300)}},{key:'init',value:function init(){window.location.href!==window.location.protocol+'//'+window.location.host+'/'+this.baseSlug&&window.location.href!==window.location.protocol+'//'+window.location.host+'/'+this.baseSlug+'/'?this.checkUrl():this.displayLevel()}}]),a}();exports.default=Silo;
'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var scrollIt=exports.scrollIt=function(a,b){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:200,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'linear',f=arguments[4],g={linear:function linear(a){return a},easeInQuad:function easeInQuad(a){return a*a},easeOutQuad:function easeOutQuad(a){return a*(2-a)},easeInOutQuad:function easeInOutQuad(a){return .5>a?2*a*a:-1+(4-2*a)*a},easeInCubic:function easeInCubic(a){return a*a*a},easeOutCubic:function easeOutCubic(a){return--a*a*a+1},easeInOutCubic:function easeInOutCubic(a){return .5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},easeInQuart:function easeInQuart(a){return a*a*a*a},easeOutQuart:function easeOutQuart(a){return 1- --a*a*a*a},easeInOutQuart:function easeInOutQuart(a){return .5>a?8*a*a*a*a:1-8*--a*a*a*a},easeInQuint:function easeInQuint(a){return a*a*a*a*a},easeOutQuint:function easeOutQuint(a){return 1+--a*a*a*a*a},easeInOutQuint:function easeInOutQuint(a){return .5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}},h=window.pageYOffset,i='now'in window.performance?performance.now():new Date().getTime(),j=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),k=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName('body')[0].clientHeight,l='number'==typeof a?a:a.offsetTop,m=Math.round(j-l<k?j-k:l);function c(){var a='now'in window.performance?performance.now():new Date().getTime(),b=Math.min(1,(a-i)/d),j=g[e](b);return window.scroll(0,Math.ceil(j*(m-h)+h)),window.pageYOffset===m?void(f&&f()):void requestAnimationFrame(c)}return l=0<l?l-b:l,m=0<m?m-b:m,!1=='requestAnimationFrame'in window?(window.scroll(0,m),void(f&&f())):void c()},fadeIn=exports.fadeIn=function(a){a.style.opacity=0;var b=+new Date,c=function(){a.style.opacity=+a.style.opacity+(new Date-b)/400,b=+new Date,1>+a.style.opacity&&(window.requestAnimationFrame&&requestAnimationFrame(c)||setTimeout(c,16))};c()};
